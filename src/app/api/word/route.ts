import DB from '@/lib/db';
import { CardProps, PartOfSpeech, DictionaryAPIData, Lang } from '@/type';
import { aiClient, WordModel, wordSchema } from '@/utils/gemini';
import { NextResponse } from 'next/server';
import { zodResponseFormat } from 'openai/helpers/zod.mjs';

export async function GET(request: Request): Promise<Response> {
	const { searchParams } = new URL(request.url);
	let word = searchParams.get('word');
	if (!word) {
		return NextResponse.json({ error: 'Word is required' }, { status: 400 });
	}
	word = word.trim().toLowerCase();
	const db = DB.collection('words');
	const result = await db.findOne({ word });
	if (result) {
		if (result.avliable === false) {
			return NextResponse.json({ error: 'Word not found' }, { status: 404 });
		}
		return NextResponse.json(result, { status: 200 });
	}
	const data = await newWord(word);
	if (!data) {
		await db.insertOne({ word, avliable: false });
		return NextResponse.json({ error: 'Word not found' }, { status: 404 });
	}

	await db.insertOne(data);
	return NextResponse.json(data, { status: 200 });
}

async function newWord(word: string): Promise<CardProps | null> {
	const response = await fetch(
		`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`,
	);
	if (!response.ok) {
		return null;
	}
	const dataList = (await response.json()) as DictionaryAPIData[];
	const data = dataList[0];
	const processedData: CardProps = {
		word: data.word,
		phonetic: data.phonetic,
		blocks: data.meanings.map((meaning) => ({
			partOfSpeech: meaning.partOfSpeech as PartOfSpeech,
			definitions: meaning.definitions.map((definition) => {
				const data = {
					definition: [
						{
							lang: 'en' as Lang,
							content: definition.definition,
						},
					],
					synonyms: definition.synonyms || [],
					antonyms: definition.antonyms || [],
				};
				if (definition.example) {
					return Object.assign(data, {
						example: [
							[
								{
									lang: 'en',
									content: definition.example,
								},
							],
						],
					});
				}
				return data;
			}),
		})),
	};
	let AIResponse;
	try {
		AIResponse = await aiClient.beta.chat.completions.parse({
			model: 'gemini-2.0-flash',
			messages: [
				{
					role: 'system',
					content: `You are a professional in the field of English, and you are going to explain the word "${processedData.word}".`,
				},
				{
					role: 'system',
					content:
						'Refer to the provided data and modify it to ensure its professionalism and completeness.',
				},
				{
					role: 'system',
					content:
						'You will provide two language translations for the word: one in English and one in Traditional Chinese (Taiwan). Process the data from JSON and return it in JSON format.',
				},

				{
					role: 'user',
					content:
						'{\n  "word": "search",\n  "phonetic": "/sɜːt͡ʃ/",\n  "blocks": [\n    {\n      "partOfSpeech": "noun",\n      "definitions": [\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "An attempt to find something."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "With only five minutes until we were meant to leave, the search for the keys started in earnest."\n              }\n            ]\n          ]\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "The act of searching in general."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "Search is a hard problem for computers to solve efficiently."\n              }\n            ]\n          ]\n        }\n      ]\n    },\n    {\n      "partOfSpeech": "verb",\n      "definitions": [\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To look in (a place) for something."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "I searched the garden for the keys and found them in the vegetable patch."\n              }\n            ]\n          ]\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "(followed by \\"for\\") To look thoroughly."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "The police are searching for evidence in his flat."\n              }\n            ]\n          ]\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To look for, seek."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": []\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To probe or examine (a wound)."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": []\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To examine; to try; to put to the test."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": []\n        }\n      ]\n    }\n  ]\n}',
				},
				{
					role: 'assistant',
					content:
						'{\n  "blocks": [\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "An endeavor to locate something; an act of seeking.",\n              "lang": "en"\n            },\n            {\n              "content": "尋找某物的嘗試；搜尋的行為。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The search for a cure continues.",\n              "lang": "en"\n            },\n            {\n              "content": "對治療方法的研究仍在繼續。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "exploration",\n            "quest",\n            "hunt"\n          ]\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A systematic examination or investigation.",\n              "lang": "en"\n            },\n            {\n              "content": "系統性的檢查或調查。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The police conducted a thorough search of the premises.",\n              "lang": "en"\n            },\n            {\n              "content": "警察對房屋進行了徹底搜查。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "inspection",\n            "scan",\n            "scrutiny"\n          ]\n        }\n      ],\n      "partOfSpeech": "noun"\n    },\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To attempt to find someone or something by looking carefully.",\n              "lang": "en"\n            },\n            {\n              "content": "試圖透過仔細尋找來找到某人或某物。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "I searched my pockets for the keys.",\n              "lang": "en"\n            },\n            {\n              "content": "我在口袋裡找鑰匙。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "seek",\n            "hunt",\n            "look for"\n          ]\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To examine closely and carefully.",\n              "lang": "en"\n            },\n            {\n              "content": "仔細而認真地檢查。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "Customs officials searched the luggage.",\n              "lang": "en"\n            },\n            {\n              "content": "海關人員搜查了行李。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "inspect",\n            "scan",\n            "scrutinize"\n          ]\n        }\n      ],\n      "partOfSpeech": "verb"\n    }\n  ],\n  "phonetic": "/sɜːrtʃ/",\n  "word": "search"\n}',
				},
				{
					role: 'user',
					content:
						'[{"word":"abandon","phonetic":"/əˈbæn.dən/","phonetics":[{"text":"/əˈbæn.dən/","audio":""},{"text":"/əˈbæn.dn̩/","audio":""},{"text":"/əˈbæn.dn̩/","audio":"https://api.dictionaryapi.dev/media/pronunciations/en/abandon-us.mp3","sourceUrl":"https://commons.wikimedia.org/w/index.php?curid=1755007","license":{"name":"BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"}}],"meanings":[{"partOfSpeech":"verb","definitions":[{"definition":"To give up or relinquish control of, to surrender or to give oneself over, or to yield to one\'s emotions.","synonyms":[],"antonyms":[]},{"definition":"To desist in doing, practicing, following, holding, or adhering to; to turn away from; to permit to lapse; to renounce; to discontinue.","synonyms":[],"antonyms":[]},{"definition":"To leave behind; to desert as in a ship or a position, typically in response to overwhelming odds or impending dangers; to forsake, in spite of a duty or responsibility.","synonyms":[],"antonyms":[],"example":"Many baby girls have been abandoned on the streets of Beijing."},{"definition":"To subdue; to take control of.","synonyms":[],"antonyms":[]},{"definition":"To cast out; to banish; to expel; to reject.","synonyms":[],"antonyms":[]},{"definition":"To no longer exercise a right, title, or interest, especially with no interest of reclaiming it again; to yield; to relinquish.","synonyms":[],"antonyms":[]},{"definition":"To surrender to the insurer (an insured item), so as to claim a total loss.","synonyms":[],"antonyms":[]}],"synonyms":[],"antonyms":[]}],"license":{"name":"CC BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"},"sourceUrls":["https://en.wiktionary.org/wiki/abandon"]},{"word":"abandon","phonetic":"/əˈbæn.dən/","phonetics":[{"text":"/əˈbæn.dən/","audio":""},{"text":"/əˈbæn.dn̩/","audio":""},{"text":"/əˈbæn.dn̩/","audio":"https://api.dictionaryapi.dev/media/pronunciations/en/abandon-us.mp3","sourceUrl":"https://commons.wikimedia.org/w/index.php?curid=1755007","license":{"name":"BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"}}],"meanings":[{"partOfSpeech":"noun","definitions":[{"definition":"A yielding to natural impulses or inhibitions; freedom from artificial constraint, with loss of appreciation of consequences.","synonyms":[],"antonyms":[]},{"definition":"Abandonment; relinquishment.","synonyms":[],"antonyms":[]}],"synonyms":["abandonment","libertinism","profligacy","unconstraint","unrestraint","wantonness"],"antonyms":[]}],"license":{"name":"CC BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"},"sourceUrls":["https://en.wiktionary.org/wiki/abandon"]}]',
				},
				{
					role: 'assistant',
					content:
						'{\n  "blocks": [\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To give up or relinquish control of, to surrender or to give oneself over, or to yield to one\'s emotions.",\n              "lang": "en"\n            },\n            {\n              "content": "放棄或放棄控制，投降或委身於，或屈服於自己的情緒。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To desist in doing, practicing, following, holding, or adhering to; to turn away from; to permit to lapse; to renounce; to discontinue.",\n              "lang": "en"\n            },\n            {\n              "content": "停止做、實踐、跟隨、持有或遵守； 轉身離開； 允許失效； 宣布放棄； 停止。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To leave behind; to desert as in a ship or a position, typically in response to overwhelming odds or impending dangers; to forsake, in spite of a duty or responsibility.",\n              "lang": "en"\n            },\n            {\n              "content": "留下； 像在船上或陣地上一樣遺棄，通常是為了應對壓倒性的困難或迫在眉睫的危險； 儘管有責任或義務，還是要拋棄。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "Many baby girls have been abandoned on the streets of Beijing.",\n              "lang": "en"\n            },\n            {\n              "content": "許多女嬰被遺棄在北京街頭。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To subdue; to take control of.",\n              "lang": "en"\n            },\n            {\n              "content": "征服； 控制。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To cast out; to banish; to expel; to reject.",\n              "lang": "en"\n            },\n            {\n              "content": "拋棄； 流放； 驅逐； 拒絕。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To no longer exercise a right, title, or interest, especially with no interest of reclaiming it again; to yield; to relinquish.",\n              "lang": "en"\n            },\n            {\n              "content": "不再行使權利、所有權或利益，尤其是不再有要求權的意願； 屈服； 放棄。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To surrender to the insurer (an insured item), so as to claim a total loss.",\n              "lang": "en"\n            },\n            {\n              "content": "將（被保險物品）交給保險公司，以便索賠全部損失。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        }\n      ],\n      "partOfSpeech": "verb"\n    },\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A yielding to natural impulses or inhibitions; freedom from artificial constraint, with loss of appreciation of consequences.",\n              "lang": "en"\n            },\n            {\n              "content": "屈服於自然的衝動或抑制； 擺脫人為的束縛，卻失去了對後果的體會。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": [\n            "abandonment",\n            "libertinism",\n            "profligacy",\n            "unconstraint",\n            "unrestraint",\n            "wantonness"\n          ]\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "Abandonment; relinquishment.",\n              "lang": "en"\n            },\n            {\n              "content": "放棄； 棄權。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": [\n            "abandonment"\n          ]\n        }\n      ],\n      "partOfSpeech": "noun"\n    }\n  ],\n  "phonetic": "/əˈbæn.dən/",\n  "word": "abandon"\n}',
				},
				{
					role: 'user',
					content:
						'[{"word":"command","phonetic":"/kəˈmɑːnd/","phonetics":[{"text":"/kəˈmɑːnd/","audio":""},{"text":"/kəˈmænd/","audio":"https://api.dictionaryapi.dev/media/pronunciations/en/command-us.mp3","sourceUrl":"https://commons.wikimedia.org/w/index.php?curid=1239707","license":{"name":"BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"}}],"meanings":[{"partOfSpeech":"noun","definitions":[{"definition":"An order to do something.","synonyms":[],"antonyms":[],"example":"I was given a command to cease shooting."},{"definition":"The right or authority to order, control or dispose of; the right to be obeyed or to compel obedience.","synonyms":[],"antonyms":[],"example":"to have command of an army"},{"definition":"Power of control, direction or disposal; mastery.","synonyms":[],"antonyms":[],"example":"England has long held command of the sea"},{"definition":"A position of chief authority; a position involving the right or power to order or control.","synonyms":[],"antonyms":[],"example":"General Smith was placed in command."},{"definition":"The act of commanding; exercise or authority of influence.","synonyms":[],"antonyms":[]},{"definition":"A body or troops, or any naval or military force, under the control of a particular officer; by extension, any object or body in someone\'s charge.","synonyms":[],"antonyms":[]},{"definition":"Dominating situation; range or control or oversight; extent of view or outlook.","synonyms":[],"antonyms":[]},{"definition":"A directive to a computer program acting as an interpreter of some kind, in order to perform a specific task.","synonyms":[],"antonyms":[]},{"definition":"The degree of control a pitcher has over his pitches.","synonyms":[],"antonyms":[],"example":"He\'s got good command tonight."},{"definition":"A command performance.","synonyms":[],"antonyms":[]}],"synonyms":[],"antonyms":[]},{"partOfSpeech":"verb","definitions":[{"definition":"To order, give orders; to compel or direct with authority.","synonyms":[],"antonyms":[],"example":"The king commanded his servant to bring him dinner."},{"definition":"To have or exercise supreme power, control or authority over, especially military; to have under direction or control.","synonyms":[],"antonyms":[],"example":"to command an army or a ship"},{"definition":"To require with authority; to demand, order, enjoin.","synonyms":[],"antonyms":[],"example":"he commanded silence"},{"definition":"To dominate through ability, resources, position etc.; to overlook.","synonyms":[],"antonyms":[],"example":"Bridges commanded by a fortified house. (Motley.)"},{"definition":"To exact, compel or secure by influence; to deserve, claim.","synonyms":[],"antonyms":[],"example":"A good magistrate commands the respect and affections of the people."},{"definition":"To hold, to control the use of.","synonyms":[],"antonyms":[],"example":"The fort commanded the bay."},{"definition":"To have a view, as from a superior position.","synonyms":[],"antonyms":[]},{"definition":"To direct to come; to bestow.","synonyms":[],"antonyms":[]}],"synonyms":["decree","order"],"antonyms":[]}],"license":{"name":"CC BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"},"sourceUrls":["https://en.wiktionary.org/wiki/command"]}]',
				},
				{
					role: 'assistant',
					content:
						'{\n  "blocks": [\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "An order to do something.",\n              "lang": "en"\n            },\n            {\n              "content": "做某事的命令。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "I was given a command to cease shooting.",\n              "lang": "en"\n            },\n            {\n              "content": "我接到停止射擊的命令。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "The right or authority to order, control or dispose of; the right to be obeyed or to compel obedience.",\n              "lang": "en"\n            },\n            {\n              "content": "命令、控制或處置的權利或權威； 被服從或強迫服從的權利。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "to have command of an army",\n              "lang": "en"\n            },\n            {\n              "content": "指揮一支軍隊",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "Power of control, direction or disposal; mastery.",\n              "lang": "en"\n            },\n            {\n              "content": "控制、指揮或處置的權力； 精通。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "England has long held command of the sea",\n              "lang": "en"\n            },\n            {\n              "content": "英國長期以來控制著海洋",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A position of chief authority; a position involving the right or power to order or control.",\n              "lang": "en"\n            },\n            {\n              "content": "主要權威的職位； 涉及命令或控制的權利或權力的職位。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "General Smith was placed in command.",\n              "lang": "en"\n            },\n            {\n              "content": "史密斯將軍被任命為指揮官。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "The act of commanding; exercise or authority of influence.",\n              "lang": "en"\n            },\n            {\n              "content": "指揮的行為； 行使或影響的權威。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A body or troops, or any naval or military force, under the control of a particular officer; by extension, any object or body in someone\'s charge.",\n              "lang": "en"\n            },\n            {\n              "content": "在特定軍官控制下的部隊或任何海軍或軍事力量； 推而廣之，某人負責的任何物體或團體。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "Dominating situation; range or control or oversight; extent of view or outlook.",\n              "lang": "en"\n            },\n            {\n              "content": "支配地位； 範圍或控制或監督； 視野或前景的範圍。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A directive to a computer program acting as an interpreter of some kind, in order to perform a specific task.",\n              "lang": "en"\n            },\n            {\n              "content": "對充當某種解釋器的電腦程式的指令，以便執行特定任務。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "The degree of control a pitcher has over his pitches.",\n              "lang": "en"\n            },\n            {\n              "content": "投手對他的投球的控制程度。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "He\'s got good command tonight.",\n              "lang": "en"\n            },\n            {\n              "content": "他今晚的控制力很好。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A command performance.",\n              "lang": "en"\n            },\n            {\n              "content": "御前演出。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        }\n      ],\n      "partOfSpeech": "noun"\n    },\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To order, give orders; to compel or direct with authority.",\n              "lang": "en"\n            },\n            {\n              "content": "命令，發出命令； 以權威強迫或指示。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The king commanded his servant to bring him dinner.",\n              "lang": "en"\n            },\n            {\n              "content": "國王命令他的僕人給他帶晚餐。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To have or exercise supreme power, control or authority over, especially military; to have under direction or control.",\n              "lang": "en"\n            },\n            {\n              "content": "擁有或行使至高無上的權力、控制權或權威，特別是軍事方面的權力； 受到指導或控制。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "to command an army or a ship",\n              "lang": "en"\n            },\n            {\n              "content": "指揮一支軍隊或一艘船",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To require with authority; to demand, order, enjoin.",\n              "lang": "en"\n            },\n            {\n              "content": "以權威要求； 要求，命令，責令。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "he commanded silence",\n              "lang": "en"\n            },\n            {\n              "content": "他命令保持沉默",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To dominate through ability, resources, position etc.; to overlook.",\n              "lang": "en"\n            },\n            {\n              "content": "通過能力、資源、地位等來支配； 俯瞰。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "Bridges commanded by a fortified house. (Motley.)",\n              "lang": "en"\n            },\n            {\n              "content": "由一個防禦堅固的房子控制的橋樑。(莫特利)",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To exact, compel or secure by influence; to deserve, claim.",\n              "lang": "en"\n            },\n            {\n              "content": "通過影響力來勒索、強迫或獲得； 應得的，聲稱。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "A good magistrate commands the respect and affections of the people.",\n              "lang": "en"\n            },\n            {\n              "content": "一位好的地方行政長官贏得了人民的尊重和愛戴。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To hold, to control the use of.",\n              "lang": "en"\n            },\n            {\n              "content": "持有，控制使用。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The fort commanded the bay.",\n              "lang": "en"\n            },\n            {\n              "content": "堡壘控制著海灣。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To have a view, as from a superior position.",\n              "lang": "en"\n            },\n            {\n              "content": "從優越的位置來看。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To direct to come; to bestow.",\n              "lang": "en"\n            },\n            {\n              "content": "引導到來； 授予。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        }\n      ],\n      "partOfSpeech": "verb"\n    }\n  ],\n  "phonetic": "/kəˈmɑːnd/",\n  "word": "command"\n}',
				},

				{
					role: 'user',
					content: JSON.stringify(processedData),
				},
			],
			response_format: zodResponseFormat(wordSchema, 'data'),
		});
		const result: CardProps = AIResponse.choices[0].message
			?.parsed as CardProps;
		return result;
	} catch (error) {
		console.error('OpenAI SDK Error :', error);
		console.log('trying by google AI SDK');
		try {
			const chat = WordModel.startChat({
				history: [
					{
						role: 'user',
						parts: [
							{
								text: '{\n  "word": "search",\n  "phonetic": "/sɜːt͡ʃ/",\n  "blocks": [\n    {\n      "partOfSpeech": "noun",\n      "definitions": [\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "An attempt to find something."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "With only five minutes until we were meant to leave, the search for the keys started in earnest."\n              }\n            ]\n          ]\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "The act of searching in general."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "Search is a hard problem for computers to solve efficiently."\n              }\n            ]\n          ]\n        }\n      ]\n    },\n    {\n      "partOfSpeech": "verb",\n      "definitions": [\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To look in (a place) for something."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "I searched the garden for the keys and found them in the vegetable patch."\n              }\n            ]\n          ]\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "(followed by \\"for\\") To look thoroughly."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": [],\n          "example": [\n            [\n              {\n                "lang": "en",\n                "content": "The police are searching for evidence in his flat."\n              }\n            ]\n          ]\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To look for, seek."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": []\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To probe or examine (a wound)."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": []\n        },\n        {\n          "definition": [\n            {\n              "lang": "en",\n              "content": "To examine; to try; to put to the test."\n            }\n          ],\n          "synonyms": [],\n          "antonyms": []\n        }\n      ]\n    }\n  ]\n}',
							},
						],
					},
					{
						role: 'model',
						parts: [
							{
								text: '{\n  "blocks": [\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "An endeavor to locate something; an act of seeking.",\n              "lang": "en"\n            },\n            {\n              "content": "尋找某物的嘗試；搜尋的行為。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The search for a cure continues.",\n              "lang": "en"\n            },\n            {\n              "content": "對治療方法的研究仍在繼續。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "exploration",\n            "quest",\n            "hunt"\n          ]\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A systematic examination or investigation.",\n              "lang": "en"\n            },\n            {\n              "content": "系統性的檢查或調查。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The police conducted a thorough search of the premises.",\n              "lang": "en"\n            },\n            {\n              "content": "警察對房屋進行了徹底搜查。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "inspection",\n            "scan",\n            "scrutiny"\n          ]\n        }\n      ],\n      "partOfSpeech": "noun"\n    },\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To attempt to find someone or something by looking carefully.",\n              "lang": "en"\n            },\n            {\n              "content": "試圖透過仔細尋找來找到某人或某物。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "I searched my pockets for the keys.",\n              "lang": "en"\n            },\n            {\n              "content": "我在口袋裡找鑰匙。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "seek",\n            "hunt",\n            "look for"\n          ]\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To examine closely and carefully.",\n              "lang": "en"\n            },\n            {\n              "content": "仔細而認真地檢查。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "Customs officials searched the luggage.",\n              "lang": "en"\n            },\n            {\n              "content": "海關人員搜查了行李。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": [\n            "inspect",\n            "scan",\n            "scrutinize"\n          ]\n        }\n      ],\n      "partOfSpeech": "verb"\n    }\n  ],\n  "phonetic": "/sɜːrtʃ/",\n  "word": "search"\n}',
							},
						],
					},
					{
						role: 'user',
						parts: [
							{
								text: '[{"word":"abandon","phonetic":"/əˈbæn.dən/","phonetics":[{"text":"/əˈbæn.dən/","audio":""},{"text":"/əˈbæn.dn̩/","audio":""},{"text":"/əˈbæn.dn̩/","audio":"https://api.dictionaryapi.dev/media/pronunciations/en/abandon-us.mp3","sourceUrl":"https://commons.wikimedia.org/w/index.php?curid=1755007","license":{"name":"BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"}}],"meanings":[{"partOfSpeech":"verb","definitions":[{"definition":"To give up or relinquish control of, to surrender or to give oneself over, or to yield to one\'s emotions.","synonyms":[],"antonyms":[]},{"definition":"To desist in doing, practicing, following, holding, or adhering to; to turn away from; to permit to lapse; to renounce; to discontinue.","synonyms":[],"antonyms":[]},{"definition":"To leave behind; to desert as in a ship or a position, typically in response to overwhelming odds or impending dangers; to forsake, in spite of a duty or responsibility.","synonyms":[],"antonyms":[],"example":"Many baby girls have been abandoned on the streets of Beijing."},{"definition":"To subdue; to take control of.","synonyms":[],"antonyms":[]},{"definition":"To cast out; to banish; to expel; to reject.","synonyms":[],"antonyms":[]},{"definition":"To no longer exercise a right, title, or interest, especially with no interest of reclaiming it again; to yield; to relinquish.","synonyms":[],"antonyms":[]},{"definition":"To surrender to the insurer (an insured item), so as to claim a total loss.","synonyms":[],"antonyms":[]}],"synonyms":[],"antonyms":[]}],"license":{"name":"CC BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"},"sourceUrls":["https://en.wiktionary.org/wiki/abandon"]},{"word":"abandon","phonetic":"/əˈbæn.dən/","phonetics":[{"text":"/əˈbæn.dən/","audio":""},{"text":"/əˈbæn.dn̩/","audio":""},{"text":"/əˈbæn.dn̩/","audio":"https://api.dictionaryapi.dev/media/pronunciations/en/abandon-us.mp3","sourceUrl":"https://commons.wikimedia.org/w/index.php?curid=1755007","license":{"name":"BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"}}],"meanings":[{"partOfSpeech":"noun","definitions":[{"definition":"A yielding to natural impulses or inhibitions; freedom from artificial constraint, with loss of appreciation of consequences.","synonyms":[],"antonyms":[]},{"definition":"Abandonment; relinquishment.","synonyms":[],"antonyms":[]}],"synonyms":["abandonment","libertinism","profligacy","unconstraint","unrestraint","wantonness"],"antonyms":[]}],"license":{"name":"CC BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"},"sourceUrls":["https://en.wiktionary.org/wiki/abandon"]}]',
							},
						],
					},
					{
						role: 'model',
						parts: [
							{
								text: '{\n  "blocks": [\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To give up or relinquish control of, to surrender or to give oneself over, or to yield to one\'s emotions.",\n              "lang": "en"\n            },\n            {\n              "content": "放棄或放棄控制，投降或委身於，或屈服於自己的情緒。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To desist in doing, practicing, following, holding, or adhering to; to turn away from; to permit to lapse; to renounce; to discontinue.",\n              "lang": "en"\n            },\n            {\n              "content": "停止做、實踐、跟隨、持有或遵守； 轉身離開； 允許失效； 宣布放棄； 停止。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To leave behind; to desert as in a ship or a position, typically in response to overwhelming odds or impending dangers; to forsake, in spite of a duty or responsibility.",\n              "lang": "en"\n            },\n            {\n              "content": "留下； 像在船上或陣地上一樣遺棄，通常是為了應對壓倒性的困難或迫在眉睫的危險； 儘管有責任或義務，還是要拋棄。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "Many baby girls have been abandoned on the streets of Beijing.",\n              "lang": "en"\n            },\n            {\n              "content": "許多女嬰被遺棄在北京街頭。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To subdue; to take control of.",\n              "lang": "en"\n            },\n            {\n              "content": "征服； 控制。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To cast out; to banish; to expel; to reject.",\n              "lang": "en"\n            },\n            {\n              "content": "拋棄； 流放； 驅逐； 拒絕。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To no longer exercise a right, title, or interest, especially with no interest of reclaiming it again; to yield; to relinquish.",\n              "lang": "en"\n            },\n            {\n              "content": "不再行使權利、所有權或利益，尤其是不再有要求權的意願； 屈服； 放棄。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To surrender to the insurer (an insured item), so as to claim a total loss.",\n              "lang": "en"\n            },\n            {\n              "content": "將（被保險物品）交給保險公司，以便索賠全部損失。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        }\n      ],\n      "partOfSpeech": "verb"\n    },\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A yielding to natural impulses or inhibitions; freedom from artificial constraint, with loss of appreciation of consequences.",\n              "lang": "en"\n            },\n            {\n              "content": "屈服於自然的衝動或抑制； 擺脫人為的束縛，卻失去了對後果的體會。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": [\n            "abandonment",\n            "libertinism",\n            "profligacy",\n            "unconstraint",\n            "unrestraint",\n            "wantonness"\n          ]\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "Abandonment; relinquishment.",\n              "lang": "en"\n            },\n            {\n              "content": "放棄； 棄權。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": [\n            "abandonment"\n          ]\n        }\n      ],\n      "partOfSpeech": "noun"\n    }\n  ],\n  "phonetic": "/əˈbæn.dən/",\n  "word": "abandon"\n}',
							},
						],
					},
					{
						role: 'user',
						parts: [
							{
								text: '[{"word":"command","phonetic":"/kəˈmɑːnd/","phonetics":[{"text":"/kəˈmɑːnd/","audio":""},{"text":"/kəˈmænd/","audio":"https://api.dictionaryapi.dev/media/pronunciations/en/command-us.mp3","sourceUrl":"https://commons.wikimedia.org/w/index.php?curid=1239707","license":{"name":"BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"}}],"meanings":[{"partOfSpeech":"noun","definitions":[{"definition":"An order to do something.","synonyms":[],"antonyms":[],"example":"I was given a command to cease shooting."},{"definition":"The right or authority to order, control or dispose of; the right to be obeyed or to compel obedience.","synonyms":[],"antonyms":[],"example":"to have command of an army"},{"definition":"Power of control, direction or disposal; mastery.","synonyms":[],"antonyms":[],"example":"England has long held command of the sea"},{"definition":"A position of chief authority; a position involving the right or power to order or control.","synonyms":[],"antonyms":[],"example":"General Smith was placed in command."},{"definition":"The act of commanding; exercise or authority of influence.","synonyms":[],"antonyms":[]},{"definition":"A body or troops, or any naval or military force, under the control of a particular officer; by extension, any object or body in someone\'s charge.","synonyms":[],"antonyms":[]},{"definition":"Dominating situation; range or control or oversight; extent of view or outlook.","synonyms":[],"antonyms":[]},{"definition":"A directive to a computer program acting as an interpreter of some kind, in order to perform a specific task.","synonyms":[],"antonyms":[]},{"definition":"The degree of control a pitcher has over his pitches.","synonyms":[],"antonyms":[],"example":"He\'s got good command tonight."},{"definition":"A command performance.","synonyms":[],"antonyms":[]}],"synonyms":[],"antonyms":[]},{"partOfSpeech":"verb","definitions":[{"definition":"To order, give orders; to compel or direct with authority.","synonyms":[],"antonyms":[],"example":"The king commanded his servant to bring him dinner."},{"definition":"To have or exercise supreme power, control or authority over, especially military; to have under direction or control.","synonyms":[],"antonyms":[],"example":"to command an army or a ship"},{"definition":"To require with authority; to demand, order, enjoin.","synonyms":[],"antonyms":[],"example":"he commanded silence"},{"definition":"To dominate through ability, resources, position etc.; to overlook.","synonyms":[],"antonyms":[],"example":"Bridges commanded by a fortified house. (Motley.)"},{"definition":"To exact, compel or secure by influence; to deserve, claim.","synonyms":[],"antonyms":[],"example":"A good magistrate commands the respect and affections of the people."},{"definition":"To hold, to control the use of.","synonyms":[],"antonyms":[],"example":"The fort commanded the bay."},{"definition":"To have a view, as from a superior position.","synonyms":[],"antonyms":[]},{"definition":"To direct to come; to bestow.","synonyms":[],"antonyms":[]}],"synonyms":["decree","order"],"antonyms":[]}],"license":{"name":"CC BY-SA 3.0","url":"https://creativecommons.org/licenses/by-sa/3.0"},"sourceUrls":["https://en.wiktionary.org/wiki/command"]}]',
							},
						],
					},
					{
						role: 'model',
						parts: [
							{
								text: '{\n  "blocks": [\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "An order to do something.",\n              "lang": "en"\n            },\n            {\n              "content": "做某事的命令。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "I was given a command to cease shooting.",\n              "lang": "en"\n            },\n            {\n              "content": "我接到停止射擊的命令。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "The right or authority to order, control or dispose of; the right to be obeyed or to compel obedience.",\n              "lang": "en"\n            },\n            {\n              "content": "命令、控制或處置的權利或權威； 被服從或強迫服從的權利。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "to have command of an army",\n              "lang": "en"\n            },\n            {\n              "content": "指揮一支軍隊",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "Power of control, direction or disposal; mastery.",\n              "lang": "en"\n            },\n            {\n              "content": "控制、指揮或處置的權力； 精通。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "England has long held command of the sea",\n              "lang": "en"\n            },\n            {\n              "content": "英國長期以來控制著海洋",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A position of chief authority; a position involving the right or power to order or control.",\n              "lang": "en"\n            },\n            {\n              "content": "主要權威的職位； 涉及命令或控制的權利或權力的職位。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "General Smith was placed in command.",\n              "lang": "en"\n            },\n            {\n              "content": "史密斯將軍被任命為指揮官。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "The act of commanding; exercise or authority of influence.",\n              "lang": "en"\n            },\n            {\n              "content": "指揮的行為； 行使或影響的權威。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A body or troops, or any naval or military force, under the control of a particular officer; by extension, any object or body in someone\'s charge.",\n              "lang": "en"\n            },\n            {\n              "content": "在特定軍官控制下的部隊或任何海軍或軍事力量； 推而廣之，某人負責的任何物體或團體。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "Dominating situation; range or control or oversight; extent of view or outlook.",\n              "lang": "en"\n            },\n            {\n              "content": "支配地位； 範圍或控制或監督； 視野或前景的範圍。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A directive to a computer program acting as an interpreter of some kind, in order to perform a specific task.",\n              "lang": "en"\n            },\n            {\n              "content": "對充當某種解釋器的電腦程式的指令，以便執行特定任務。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "The degree of control a pitcher has over his pitches.",\n              "lang": "en"\n            },\n            {\n              "content": "投手對他的投球的控制程度。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "He\'s got good command tonight.",\n              "lang": "en"\n            },\n            {\n              "content": "他今晚的控制力很好。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "A command performance.",\n              "lang": "en"\n            },\n            {\n              "content": "御前演出。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        }\n      ],\n      "partOfSpeech": "noun"\n    },\n    {\n      "definitions": [\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To order, give orders; to compel or direct with authority.",\n              "lang": "en"\n            },\n            {\n              "content": "命令，發出命令； 以權威強迫或指示。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The king commanded his servant to bring him dinner.",\n              "lang": "en"\n            },\n            {\n              "content": "國王命令他的僕人給他帶晚餐。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To have or exercise supreme power, control or authority over, especially military; to have under direction or control.",\n              "lang": "en"\n            },\n            {\n              "content": "擁有或行使至高無上的權力、控制權或權威，特別是軍事方面的權力； 受到指導或控制。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "to command an army or a ship",\n              "lang": "en"\n            },\n            {\n              "content": "指揮一支軍隊或一艘船",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To require with authority; to demand, order, enjoin.",\n              "lang": "en"\n            },\n            {\n              "content": "以權威要求； 要求，命令，責令。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "he commanded silence",\n              "lang": "en"\n            },\n            {\n              "content": "他命令保持沉默",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To dominate through ability, resources, position etc.; to overlook.",\n              "lang": "en"\n            },\n            {\n              "content": "通過能力、資源、地位等來支配； 俯瞰。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "Bridges commanded by a fortified house. (Motley.)",\n              "lang": "en"\n            },\n            {\n              "content": "由一個防禦堅固的房子控制的橋樑。(莫特利)",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To exact, compel or secure by influence; to deserve, claim.",\n              "lang": "en"\n            },\n            {\n              "content": "通過影響力來勒索、強迫或獲得； 應得的，聲稱。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "A good magistrate commands the respect and affections of the people.",\n              "lang": "en"\n            },\n            {\n              "content": "一位好的地方行政長官贏得了人民的尊重和愛戴。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To hold, to control the use of.",\n              "lang": "en"\n            },\n            {\n              "content": "持有，控制使用。",\n              "lang": "tw"\n            }\n          ],\n          "example": [\n            {\n              "content": "The fort commanded the bay.",\n              "lang": "en"\n            },\n            {\n              "content": "堡壘控制著海灣。",\n              "lang": "tw"\n            }\n          ],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To have a view, as from a superior position.",\n              "lang": "en"\n            },\n            {\n              "content": "從優越的位置來看。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        },\n        {\n          "antonyms": [],\n          "definition": [\n            {\n              "content": "To direct to come; to bestow.",\n              "lang": "en"\n            },\n            {\n              "content": "引導到來； 授予。",\n              "lang": "tw"\n            }\n          ],\n          "example": [],\n          "synonyms": []\n        }\n      ],\n      "partOfSpeech": "verb"\n    }\n  ],\n  "phonetic": "/kəˈmɑːnd/",\n  "word": "command"\n}',
							},
						],
					},
				],
			});
			AIResponse = await chat.sendMessage(`
				data : ${JSON.stringify(processedData)}
				it have ${processedData.blocks.length} blocks(part of speech)
				Please response with all the blocks
				`);
			const result: CardProps = JSON.parse(AIResponse.response.text());
			return result;
		} catch (error) {
			console.error('Error parsing AI response:', error);
		}
	}
	return processedData;
}
